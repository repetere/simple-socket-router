!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).els={})}(this,function(e){"use strict";var t=function(e){var t,o=[];return e instanceof RegExp?(t=e,e.toString()):(t=r(e,o),e),{re:t,src:e.toString(),keys:o}},r=function(e,t){return e=e.concat("/?").replace(/\/\(/g,"(?:/").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?|\*/g,function(e,r,o,n,s,u){return"*"===e?(t.push(void 0),e):(t.push(n),r=r||"",(u?"":r)+"(?:"+(u?r:"")+(o||"")+(s||"([^/]+?)")+")"+(u||""))}).replace(/([\/.])/g,"\\$1").replace(/\*/g,"(.*)"),new RegExp("^"+e+"$","i")},o=function(e,t,r){for(var o,n=r||0,s=e.length;n<s;++n){var u=e[n],a=u.re,i=u.keys,c=[],p={};if(o=t.match(a)){var f=1;for(s=o.length;f<s;++f){var h=i[f-1],l="string"==typeof o[f]?unescape(o[f]):o[f];h?p[h]=l:c.push(l)}return{params:p,splats:c,route:u.src,next:n+1}}}},n=function(){return{routes:[],routeMap:{},addRoute:function(e,r){if(!e)throw new Error(" route requires a path");if(!r)throw new Error(" route "+e.toString()+" requires a callback");if(this.routeMap[e])throw new Error("path is already defined: "+e);var o=t(e);o.fn=r,this.routes.push(o),this.routeMap[e]=r},removeRoute:function(e){if(!e)throw new Error(" route requires a path");if(!this.routeMap[e])throw new Error("path does not exist: "+e);for(var t=[],r=0;r<this.routes.length;r++){var o=this.routes[r];o.src!==e&&t.push(o)}this.routes=t,delete this.routeMap[e]},match:function(e,t){var r=o(this.routes,e,t);return r&&(r.fn=this.routeMap[r.route],r.next=this.match.bind(this,e,r.next)),r}}};n.Route=t,n.pathToRegExp=r,n.match=o,n.Router=n;const s=n;function u({socket:e,router:t}){return function(r,o){const[n,s]=r,u=t.match(n),a={path:n,body:s,socket:e};let i=e=>e;const c={send(t){try{e.emit(n,i(t)),i=null}catch(t){e.emit("error",new Error("Response already sent"))}}};u&&(a.params=u.params,a.splats=u.splats,u.fn(a,c,u)),o()}}e.Router=s,e.EventRouter=function({socket:e,router:t}){e.use?e.use(u({socket:e,router:t})):function(e,t){e._onevent=e.onevent;const r=()=>{};e.onevent=function(o){t(o.data,r);const n=new Array(arguments.length);for(var s=0;s<n.length;++s)n[s]=arguments[s];e._onevent.apply(e,n)}}(e,u({socket:e,router:t}))},Object.defineProperty(e,"__esModule",{value:!0})});
